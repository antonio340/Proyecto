import{_ as p,c as a,a as r,w as u,d as m,v as c,F as P,r as h,t as n,n as g,o as l}from"./index-C2tANWuT.js";const y={name:"Pedidos",data(){return{pedidos:[],idProducto:"",idPedidoEliminar:"",mensaje:"",mensajeError:!1}},methods:{async cargarPedidos(){try{const t=localStorage.getItem("token"),s=await(await fetch("http://localhost/apiVentas/api/public/pedidos",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}})).json();this.pedidos=Array.isArray(s)?s:s.pedidos||[],this.mostrarMensaje("Pedidos cargados",!1)}catch(t){console.error("Error al cargar pedidos:",t),this.mostrarMensaje("Error al cargar pedidos",!0)}},async crearPedido(){try{const t=localStorage.getItem("token"),e=await fetch("http://localhost/apiVentas/api/public/pedidos",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({idProducto:this.idProducto})});if(e.ok)this.mostrarMensaje("Pedido creado",!1),this.idProducto="",this.cargarPedidos();else{const s=await e.json();throw new Error(s.message||"Error al crear pedido")}}catch(t){console.error("Error al crear pedido:",t),this.mostrarMensaje("Error al crear pedido",!0)}},async eliminarPedido(){if(!this.idPedidoEliminar){this.mostrarMensaje("Ingresa un ID válido",!0);return}try{const t=localStorage.getItem("token"),e=await fetch("http://localhost/apiVentas/api/public/pedidos",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({idPedido:this.idPedidoEliminar})});if(!e.ok){const s=await e.json();throw new Error(s.message||"Error al eliminar el pedido")}this.mostrarMensaje("Pedido eliminado correctamente",!1),this.idPedidoEliminar="",this.cargarPedidos()}catch(t){this.mostrarMensaje(t.message,!0),console.error("Error completo:",t)}},mostrarMensaje(t,e){this.mensaje=t,this.mensajeError=e,setTimeout(()=>{this.mensaje=""},3e3)}},mounted(){this.cargarPedidos()}},E={class:"pedidos-container"},f={class:"form-container"},j={class:"list-container"},b={key:0},k={key:1},w={class:"form-container"};function v(t,e,s,I,i,d){return l(),a("div",E,[e[11]||(e[11]=r("h1",null,"Gestión de Pedidos",-1)),r("div",f,[e[6]||(e[6]=r("h2",null,"Crear Pedido",-1)),r("form",{onSubmit:e[1]||(e[1]=u((...o)=>d.crearPedido&&d.crearPedido(...o),["prevent"]))},[m(r("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>i.idProducto=o),type:"number",placeholder:"ID del Producto",required:""},null,512),[[c,i.idProducto]]),e[5]||(e[5]=r("button",{type:"submit"},"Crear Pedido",-1))],32)]),r("div",j,[e[8]||(e[8]=r("h2",null,"Listado de Pedidos",-1)),r("button",{onClick:e[2]||(e[2]=(...o)=>d.cargarPedidos&&d.cargarPedidos(...o))},"Cargar Pedidos"),i.pedidos.length?(l(),a("table",b,[e[7]||(e[7]=r("thead",null,[r("tr",null,[r("th",null,"ID Pedido"),r("th",null,"ID Usuario"),r("th",null,"ID Producto"),r("th",null,"Nombre"),r("th",null,"Precio")])],-1)),r("tbody",null,[(l(!0),a(P,null,h(i.pedidos,o=>(l(),a("tr",{key:o.idPedido},[r("td",null,n(o.idPedido),1),r("td",null,n(o.idUsuario),1),r("td",null,n(o.idProducto),1),r("td",null,n(o.nombreProducto),1),r("td",null,n(o.precioProducto),1)]))),128))])])):(l(),a("p",k,"No hay pedidos registrados"))]),r("div",w,[e[10]||(e[10]=r("h2",null,"Eliminar Pedido",-1)),r("form",{onSubmit:e[4]||(e[4]=u((...o)=>d.eliminarPedido&&d.eliminarPedido(...o),["prevent"]))},[m(r("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>i.idPedidoEliminar=o),type:"number",placeholder:"ID del Pedido",required:""},null,512),[[c,i.idPedidoEliminar]]),e[9]||(e[9]=r("button",{type:"submit",class:"delete-btn"},"Eliminar Pedido",-1))],32)]),r("p",{class:g({error:i.mensajeError,success:!i.mensajeError})},n(i.mensaje),3)])}const D=p(y,[["render",v],["__scopeId","data-v-a9faca39"]]);export{D as default};
