import{_ as p,c as i,a as o,d as c,v as d,t as l,n as m,F as h,r as P,o as u}from"./index-COV2sJcL.js";const E={name:"AdminProductos",data(){return{productos:[],producto:{idProducto:"",nombreProducto:"",precioProducto:""},idEliminar:"",mensaje:"",mensajeError:!1}},methods:{async cargarProductos(){try{const e=localStorage.getItem("token"),r=await fetch("http://localhost/apiVentas/api/public/productos",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});this.productos=await r.json(),this.mostrarMensaje("Productos cargados",!1)}catch(e){console.error("Error al cargar productos:",e),this.mostrarMensaje("Error al cargar productos",!0)}},async crearProducto(){if(!this.producto.nombreProducto||!this.producto.precioProducto){this.mostrarMensaje("Nombre y precio son requeridos",!0);return}try{const e=localStorage.getItem("token"),r=await fetch("http://localhost/apiVentas/api/public/productos",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({nombreProducto:this.producto.nombreProducto,precioProducto:parseFloat(this.producto.precioProducto)})});if(r.ok)this.mostrarMensaje("Producto creado",!1),this.resetForm(),this.cargarProductos();else{const n=await r.json();throw new Error(n.message||"Error en la respuesta")}}catch(e){console.error("Error al crear producto:",e),this.mostrarMensaje("Error al crear producto",!0)}},async actualizarProducto(){if(!this.producto.idProducto||!this.producto.nombreProducto||!this.producto.precioProducto){this.mostrarMensaje("ID, nombre y precio son requeridos",!0);return}try{const e=localStorage.getItem("token"),r=await fetch(`http://localhost/apiVentas/api/public/productos/${this.producto.idProducto}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({nombreProducto:this.producto.nombreProducto,precioProducto:parseFloat(this.producto.precioProducto)})});if(r.ok)this.mostrarMensaje("Producto actualizado",!1),this.resetForm(),this.cargarProductos();else{const n=await r.json();throw new Error(n.message||"Error en la respuesta")}}catch(e){console.error("Error al actualizar producto:",e),this.mostrarMensaje("Error al actualizar producto",!0)}},async eliminarProducto(){if(!this.idEliminar){this.mostrarMensaje("Ingresa un ID vÃ¡lido",!0);return}try{const e=localStorage.getItem("token"),r=await fetch(`http://localhost/apiVentas/api/public/productos/${this.idEliminar}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(r.ok)this.mostrarMensaje("Producto eliminado",!1),this.idEliminar="",this.cargarProductos();else{const n=await r.json();throw new Error(n.message||"Error en la respuesta")}}catch(e){console.error("Error al eliminar producto:",e),this.mostrarMensaje("Error al eliminar producto",!0)}},resetForm(){this.producto={idProducto:"",nombreProducto:"",precioProducto:""}},mostrarMensaje(e,r){this.mensaje=e,this.mensajeError=r,setTimeout(()=>this.mensaje="",3e3)}},mounted(){this.cargarProductos()}},b={class:"admin-productos"},g={class:"form-container"},j={class:"form-container"},y={class:"productos-list"},f={key:0},k={key:1};function w(e,r,n,z,s,a){return u(),i("div",b,[r[12]||(r[12]=o("h1",null,"Administrar Productos",-1)),o("div",g,[r[8]||(r[8]=o("h2",null,"Crear / Actualizar Producto",-1)),c(o("input",{"onUpdate:modelValue":r[0]||(r[0]=t=>s.producto.idProducto=t),type:"number",placeholder:"ID (para actualizar)"},null,512),[[d,s.producto.idProducto]]),c(o("input",{"onUpdate:modelValue":r[1]||(r[1]=t=>s.producto.nombreProducto=t),type:"text",placeholder:"Nombre",required:""},null,512),[[d,s.producto.nombreProducto]]),c(o("input",{"onUpdate:modelValue":r[2]||(r[2]=t=>s.producto.precioProducto=t),type:"number",step:"0.01",placeholder:"Precio",required:""},null,512),[[d,s.producto.precioProducto]]),o("button",{onClick:r[3]||(r[3]=(...t)=>a.crearProducto&&a.crearProducto(...t))},"Crear"),o("button",{onClick:r[4]||(r[4]=(...t)=>a.actualizarProducto&&a.actualizarProducto(...t))},"Actualizar")]),o("div",j,[r[9]||(r[9]=o("h2",null,"Eliminar Producto",-1)),c(o("input",{"onUpdate:modelValue":r[5]||(r[5]=t=>s.idEliminar=t),type:"number",placeholder:"ID del producto"},null,512),[[d,s.idEliminar]]),o("button",{class:"delete-btn",onClick:r[6]||(r[6]=(...t)=>a.eliminarProducto&&a.eliminarProducto(...t))},"Eliminar")]),o("p",{class:m({error:s.mensajeError,success:!s.mensajeError})},l(s.mensaje),3),o("div",y,[r[11]||(r[11]=o("h2",null,"Productos Existentes",-1)),o("button",{onClick:r[7]||(r[7]=(...t)=>a.cargarProductos&&a.cargarProductos(...t))},"Refrescar Lista"),s.productos.length?(u(),i("table",f,[r[10]||(r[10]=o("thead",null,[o("tr",null,[o("th",null,"ID"),o("th",null,"Nombre"),o("th",null,"Precio")])],-1)),o("tbody",null,[(u(!0),i(h,null,P(s.productos,t=>(u(),i("tr",{key:t.idProducto},[o("td",null,l(t.idProducto),1),o("td",null,l(t.nombreProducto),1),o("td",null,l(t.precioProducto),1)]))),128))])])):(u(),i("p",k,"No hay productos registrados"))])])}const C=p(E,[["render",w],["__scopeId","data-v-8fdc6943"]]);export{C as default};
