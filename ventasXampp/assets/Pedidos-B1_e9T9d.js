import{_ as c,c as n,a as r,w as u,d as m,v as p,F as P,r as h,t as l,n as g,o as a}from"./index-DO5KRarb.js";const E={name:"Pedidos",data(){return{pedidos:[],nuevoPedido:{idProducto:""},idPedidoEliminar:"",mensaje:"",mensajeError:!1}},methods:{async cargarPedidos(){try{const o=localStorage.getItem("token"),s=await(await fetch("http://localhost/apiVentas/api/public/pedidos",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}})).json();this.pedidos=Array.isArray(s)?s:s.pedidos||[],this.mostrarMensaje("Pedidos cargados",!1)}catch(o){console.error("Error al cargar pedidos:",o),this.mostrarMensaje("Error al cargar pedidos",!0)}},async crearPedido(){try{const o=localStorage.getItem("token"),e=await fetch("http://localhost/apiVentas/api/public/pedidos",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({idProducto:this.nuevoPedido.idProducto})});if(e.ok)this.mostrarMensaje("Pedido creado",!1),this.nuevoPedido.idProducto="",this.cargarPedidos();else{const s=await e.json();throw new Error(s.message||"Error al crear pedido")}}catch(o){console.error("Error al crear pedido:",o),this.mostrarMensaje("Error al crear pedido",!0)}},async eliminarPedido(){if(!this.idPedidoEliminar){this.mostrarMensaje("Ingresa un ID válido",!0);return}try{const o=localStorage.getItem("token"),e=await fetch(`http://localhost/apiVentas/api/public/pedidos/${this.idPedidoEliminar}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}});if(!e.ok){const s=await e.json();throw new Error(s.message||"Error al eliminar pedido")}this.mostrarMensaje("Pedido eliminado correctamente",!1),this.idPedidoEliminar="",this.cargarPedidos()}catch(o){console.error("Error al eliminar pedido:",o),this.mostrarMensaje(o.message,!0)}},mostrarMensaje(o,e){this.mensaje=o,this.mensajeError=e,setTimeout(()=>{this.mensaje=""},3e3)}},mounted(){this.cargarPedidos()}},y={class:"pedidos-container"},f={class:"form-container"},j={class:"list-container"},b={key:0},v={key:1},k={class:"form-container"};function w(o,e,s,I,t,d){return a(),n("div",y,[e[11]||(e[11]=r("h1",null,"Gestión de Pedidos",-1)),r("div",f,[e[6]||(e[6]=r("h2",null,"Crear Pedido",-1)),r("form",{onSubmit:e[1]||(e[1]=u((...i)=>d.crearPedido&&d.crearPedido(...i),["prevent"]))},[m(r("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>t.nuevoPedido.idProducto=i),type:"number",placeholder:"ID del Producto",required:""},null,512),[[p,t.nuevoPedido.idProducto]]),e[5]||(e[5]=r("button",{type:"submit"},"Crear Pedido",-1))],32)]),r("div",j,[e[8]||(e[8]=r("h2",null,"Listado de Pedidos",-1)),r("button",{onClick:e[2]||(e[2]=(...i)=>d.cargarPedidos&&d.cargarPedidos(...i))},"Cargar Pedidos"),t.pedidos.length?(a(),n("table",b,[e[7]||(e[7]=r("thead",null,[r("tr",null,[r("th",null,"ID Pedido"),r("th",null,"ID Usuario"),r("th",null,"ID Producto")])],-1)),r("tbody",null,[(a(!0),n(P,null,h(t.pedidos,i=>(a(),n("tr",{key:i.idPedido},[r("td",null,l(i.idPedido),1),r("td",null,l(i.idUsuario),1),r("td",null,l(i.idProducto),1)]))),128))])])):(a(),n("p",v,"No hay pedidos registrados"))]),r("div",k,[e[10]||(e[10]=r("h2",null,"Eliminar Pedido",-1)),r("form",{onSubmit:e[4]||(e[4]=u((...i)=>d.eliminarPedido&&d.eliminarPedido(...i),["prevent"]))},[m(r("input",{"onUpdate:modelValue":e[3]||(e[3]=i=>t.idPedidoEliminar=i),type:"number",placeholder:"ID del Pedido",required:""},null,512),[[p,t.idPedidoEliminar]]),e[9]||(e[9]=r("button",{type:"submit",class:"delete-btn"},"Eliminar Pedido",-1))],32)]),r("p",{class:g({error:t.mensajeError,success:!t.mensajeError})},l(t.mensaje),3)])}const D=c(E,[["render",w],["__scopeId","data-v-1d6014db"]]);export{D as default};
