import{_ as p,c as n,a as r,d as u,v as d,t as l,n as m,F as h,r as P,o as c}from"./index-CKdetFWN.js";const b={name:"AdminProductos",data(){return{productos:[],producto:{idProducto:"",nombreProducto:"",precioProducto:""},idEliminar:"",mensaje:"",mensajeError:!1}},methods:{async cargarProductos(){try{const o=await(await fetch("http://localhost/apiVentas/api/public/productos",{method:"GET",headers:{"Content-Type":"application/json"}})).json();o.productos?(this.productos=o.productos,this.mostrarMensaje("Productos cargados",!1)):(this.productos=[],this.mostrarMensaje("No se encontraron productos",!0))}catch(e){console.error("Error al cargar productos:",e),this.mostrarMensaje("Error al cargar productos",!0)}},async crearProducto(){if(!this.producto.nombreProducto||!this.producto.precioProducto){this.mostrarMensaje("Nombre y precio son requeridos",!0);return}try{const e=localStorage.getItem("token"),o=await fetch("http://localhost/apiVentas/api/public/productos",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({nombreProducto:this.producto.nombreProducto,precioProducto:parseFloat(this.producto.precioProducto)})});if(o.ok)this.mostrarMensaje("Producto creado correctamente",!1),this.resetForm(),this.cargarProductos();else{const i=await o.json();throw new Error(i.message||"Error al crear el producto")}}catch(e){console.error("Error al crear producto:",e),this.mostrarMensaje("Error al crear producto",!0)}},async actualizarProducto(){if(!this.producto.idProducto||!this.producto.nombreProducto||!this.producto.precioProducto){this.mostrarMensaje("ID, nombre y precio son requeridos",!0);return}try{const e=localStorage.getItem("token"),o=await fetch("http://localhost/apiVentas/api/public/productos",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({idProducto:this.producto.idProducto,nombreProducto:this.producto.nombreProducto,precioProducto:parseFloat(this.producto.precioProducto)})});if(o.ok)this.mostrarMensaje("Producto actualizado correctamente",!1),this.resetForm(),this.cargarProductos();else{const i=await o.json();throw new Error(i.message||"Error al actualizar el producto")}}catch(e){console.error("Error al actualizar producto:",e),this.mostrarMensaje("Error al actualizar producto",!0)}},async eliminarProducto(){if(!this.idEliminar){this.mostrarMensaje("Ingresa un ID vÃ¡lido",!0);return}try{const e=localStorage.getItem("token"),o=await fetch("http://localhost/apiVentas/api/public/productos",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({idProducto:this.idEliminar})});if(o.ok)this.mostrarMensaje("Producto eliminado correctamente",!1),this.idEliminar="",this.cargarProductos();else{const i=await o.json();throw new Error(i.message||"Error al eliminar el producto")}}catch(e){console.error("Error al eliminar producto:",e),this.mostrarMensaje("Error al eliminar producto",!0)}},resetForm(){this.producto={idProducto:"",nombreProducto:"",precioProducto:""}},mostrarMensaje(e,o){this.mensaje=e,this.mensajeError=o,setTimeout(()=>this.mensaje="",3e3)}},mounted(){this.cargarProductos()}},f={class:"admin-productos"},E={class:"form-container"},y={class:"form-container"},j={class:"productos-list"},g={key:0},k={key:1};function w(e,o,i,z,s,a){return c(),n("div",f,[o[12]||(o[12]=r("h1",null,"Administrar Productos",-1)),r("div",E,[o[8]||(o[8]=r("h2",null,"Crear / Actualizar Producto",-1)),u(r("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>s.producto.idProducto=t),type:"number",placeholder:"ID (para actualizar)"},null,512),[[d,s.producto.idProducto]]),u(r("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>s.producto.nombreProducto=t),type:"text",placeholder:"Nombre",required:""},null,512),[[d,s.producto.nombreProducto]]),u(r("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>s.producto.precioProducto=t),type:"number",step:"0.01",placeholder:"Precio",required:""},null,512),[[d,s.producto.precioProducto]]),r("button",{onClick:o[3]||(o[3]=(...t)=>a.crearProducto&&a.crearProducto(...t))},"Crear"),r("button",{onClick:o[4]||(o[4]=(...t)=>a.actualizarProducto&&a.actualizarProducto(...t))},"Actualizar")]),r("div",y,[o[9]||(o[9]=r("h2",null,"Eliminar Producto",-1)),u(r("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>s.idEliminar=t),type:"number",placeholder:"ID del producto"},null,512),[[d,s.idEliminar]]),r("button",{class:"delete-btn",onClick:o[6]||(o[6]=(...t)=>a.eliminarProducto&&a.eliminarProducto(...t))},"Eliminar")]),r("p",{class:m({error:s.mensajeError,success:!s.mensajeError})},l(s.mensaje),3),r("div",j,[o[11]||(o[11]=r("h2",null,"Productos Existentes",-1)),r("button",{onClick:o[7]||(o[7]=(...t)=>a.cargarProductos&&a.cargarProductos(...t))},"Refrescar Lista"),s.productos.length?(c(),n("table",g,[o[10]||(o[10]=r("thead",null,[r("tr",null,[r("th",null,"ID"),r("th",null,"Nombre"),r("th",null,"Precio")])],-1)),r("tbody",null,[(c(!0),n(h,null,P(s.productos,t=>(c(),n("tr",{key:t.idProducto},[r("td",null,l(t.idProducto),1),r("td",null,l(t.nombreProducto),1),r("td",null,l(t.precioProducto),1)]))),128))])])):(c(),n("p",k,"No hay productos registrados"))])])}const C=p(b,[["render",w],["__scopeId","data-v-7ff0afdf"]]);export{C as default};
